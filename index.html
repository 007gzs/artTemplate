<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Arttemplate : 超快的前端模板引擎" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Arttemplate</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/aui/artTemplate">View on GitHub</a>

          <h1 id="project_title">Arttemplate</h1>
          <h2 id="project_tagline">超快的前端模板引擎</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/aui/artTemplate/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/aui/artTemplate/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="arttemplate" class="anchor" href="#arttemplate"><span class="octicon octicon-link"></span></a>artTemplate</h1>

<h6>
<a name="%E6%96%B0%E4%B8%80%E4%BB%A3-javascript-%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E" class="anchor" href="#%E6%96%B0%E4%B8%80%E4%BB%A3-javascript-%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E"><span class="octicon octicon-link"></span></a>新一代 javascript 模板引擎</h6>

<p>artTemplate 是新一代 javascript 模板引擎，它在 v8 中的渲染效率可接近 javascript 性能极限，在 chrome 下渲染效率测试中分别是知名引擎 Mustache 与 micro tmpl 的 25 、 32 倍（<a href="http://aui.github.com/artTemplate/test/test-speed.html">性能测试</a>）。</p>

<p>引擎支持调试。若渲染中遇到错误，调试器可精确定位到产生异常的模板语句，解决前端模板难以调试的问题（<a href="http://aui.github.io/artTemplate/demo/debug.html">详情</a>）。</p>

<p>另外，artTemplate 的模板还支持使用自动化工具预编译，支持将模板转换为 js 文件。</p>

<h2>
<a name="%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B" class="anchor" href="#%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B"><span class="octicon octicon-link"></span></a>快速上手</h2>

<h3>
<a name="%E5%BC%95%E7%94%A8%E5%BC%95%E6%93%8E" class="anchor" href="#%E5%BC%95%E7%94%A8%E5%BC%95%E6%93%8E"><span class="octicon octicon-link"></span></a>引用引擎</h3>

<pre><code>&lt;script src="dist/template.js"&gt;&lt;/script&gt;
</code></pre>

<p>直接下载 <a href="https://raw.github.com/aui/artTemplate/master/dist/template.js">template.js</a></p>

<h3>
<a name="%E7%BC%96%E5%86%99%E6%A8%A1%E6%9D%BF" class="anchor" href="#%E7%BC%96%E5%86%99%E6%A8%A1%E6%9D%BF"><span class="octicon octicon-link"></span></a>编写模板</h3>

<p>使用一个<code>type="text/html"</code>的<code>script</code>标签存放模板：</p>

<pre><code>&lt;script id="test" type="text/html"&gt;
&lt;h1&gt;&lt;%=title%&gt;&lt;/h1&gt;
&lt;ul&gt;
    &lt;%for(i = 0; i &lt; list.length; i ++) {%&gt;
        &lt;li&gt;条目内容 &lt;%=i + 1%&gt; ：&lt;%=list[i]%&gt;&lt;/li&gt;
    &lt;%}%&gt;
&lt;/ul&gt;
&lt;/script&gt;
</code></pre>

<p>模板逻辑语法开始与结束的界定符号为<code>&lt;%</code> 与<code>%&gt;</code>，若<code>&lt;%</code>后面紧跟<code>=</code>号则输出变量内容。</p>

<h3>
<a name="%E6%B8%B2%E6%9F%93%E6%A8%A1%E6%9D%BF" class="anchor" href="#%E6%B8%B2%E6%9F%93%E6%A8%A1%E6%9D%BF"><span class="octicon octicon-link"></span></a>渲染模板</h3>

<p><code>template.render(id, data)</code></p>

<pre><code>var data = {
    title: '标签',
    list: ['文艺', '博客', '摄影', '电影', '民谣', '旅行', '吉他']
};
var html = template.render('test', data);
document.getElementById('content').innerHTML = html;
</code></pre>

<p><a href="http://aui.github.com/artTemplate/demo/basic.html">演示</a></p>

<h2>
<a name="%E5%B5%8C%E5%85%A5%E5%AD%90%E6%A8%A1%E6%9D%BF" class="anchor" href="#%E5%B5%8C%E5%85%A5%E5%AD%90%E6%A8%A1%E6%9D%BF"><span class="octicon octicon-link"></span></a>嵌入子模板</h2>

<p><code>&lt;%include(id, [data])%&gt;</code>语句可以嵌入子模板，其中第二个参数是可选的，它默认传入当前的数据。</p>

<pre><code>&lt;script id="test" type="text/html"&gt;
&lt;h1&gt;&lt;%=title%&gt;&lt;/h1&gt;
&lt;%include('list')%&gt;
&lt;/script&gt;

&lt;script id="list" type="text/html"&gt;
&lt;ul&gt;
    &lt;%for(i = 0; i &lt; list.length; i ++) {%&gt;
        &lt;li&gt;条目内容 &lt;%=i + 1%&gt; ：&lt;%=list[i]%&gt;&lt;/li&gt;
    &lt;%}%&gt;
&lt;/ul&gt;
&lt;/script&gt;
</code></pre>

<p><a href="http://aui.github.com/artTemplate/demo/include.html">演示</a></p>

<h2>
<a name="%E4%B8%8D%E8%BD%AC%E4%B9%89html" class="anchor" href="#%E4%B8%8D%E8%BD%AC%E4%B9%89html"><span class="octicon octicon-link"></span></a>不转义HTML</h2>

<p>模板引擎默认数据包含的 HTML 字符进行转义以避免 XSS 漏洞，若不需要转义的地方可使用<code>==</code>。</p>

<pre><code>&lt;script id="test" type="text/html"&gt;
&lt;%==value%&gt;
&lt;/script&gt;
</code></pre>

<p>若需要关闭默认转义，可以设置<code>template.isEscape = false</code>。</p>

<p><a href="http://aui.github.com/artTemplate/demo/no-escape.html">演示</a></p>

<h2>
<a name="%E5%9C%A8js%E4%B8%AD%E5%AD%98%E6%94%BE%E6%A8%A1%E6%9D%BF" class="anchor" href="#%E5%9C%A8js%E4%B8%AD%E5%AD%98%E6%94%BE%E6%A8%A1%E6%9D%BF"><span class="octicon octicon-link"></span></a>在js中存放模板</h2>

<p><code>template.compile([id], source)</code>将返回一个渲染函数。其中 id 参数是可选的，如果使用了 id 参数，可以使用<code>template.render(id, data)</code>渲染模板。</p>

<pre><code>var source =
  '&lt;ul&gt;'
+    '&lt;% for (var i = 0; i &lt; list.length; i ++) { %&gt;'
+        '&lt;li&gt;索引 &lt;%= i + 1 %&gt; ：&lt;%= list[i] %&gt;&lt;/li&gt;'
+    '&lt;% } %&gt;'
+ '&lt;/ul&gt;';

var data = {
    list: ['文艺', '博客', '摄影', '电影', '民谣', '旅行', '吉他']
};

var render = template.compile(source);
var html = render(data);
document.getElementById('content').innerHTML = html;
</code></pre>

<p><a href="http://aui.github.com/artTemplate/demo/compile.html">演示</a></p>

<h2>
<a name="%E6%B7%BB%E5%8A%A0%E8%BE%85%E5%8A%A9%E6%96%B9%E6%B3%95" class="anchor" href="#%E6%B7%BB%E5%8A%A0%E8%BE%85%E5%8A%A9%E6%96%B9%E6%B3%95"><span class="octicon octicon-link"></span></a>添加辅助方法</h2>

<p><code>template.helper(name, callback)</code>辅助方法一般用来进行字符串替换，如 UBB 替换、脏话替换等。</p>

<p>例如扩展一个UBB替换方法：</p>

<pre><code>template.helper('$ubb2html', function (content) {
    return content
    .replace(/\[b\]([^\[]*?)\[\/b\]/igm, '&lt;b&gt;$1&lt;/b&gt;')
    .replace(/\[i\]([^\[]*?)\[\/i\]/igm, '&lt;i&gt;$1&lt;/i&gt;')
    .replace(/\[u\]([^\[]*?)\[\/u\]/igm, '&lt;u&gt;$1&lt;/u&gt;')
    .replace(/\[url=([^\]]*)\]([^\[]*?)\[\/url\]/igm, '&lt;a href="$1"&gt;$2&lt;/a&gt;')
    .replace(/\[img\]([^\[]*?)\[\/img\]/igm, '&lt;img src="$1" /&gt;');
});
</code></pre>

<p>在模板中的使用方式：</p>

<pre><code>&lt;%=$ubb2html(content) %&gt;
</code></pre>

<p>注意：引擎不会对辅助方法输出的 HTML 字符进行转义。</p>

<p><a href="http://aui.github.com/artTemplate/demo/helper.html">演示</a></p>

<h2>
<a name="%E8%AE%BE%E7%BD%AE%E7%95%8C%E5%AE%9A%E7%AC%A6" class="anchor" href="#%E8%AE%BE%E7%BD%AE%E7%95%8C%E5%AE%9A%E7%AC%A6"><span class="octicon octicon-link"></span></a>设置界定符</h2>

<p>若前端模板语法与后端语法产生冲突，可以修改模板引擎界定符，例如：</p>

<pre><code>template.openTag = "&lt;!--[";
template.closeTag = "]--&gt;";
</code></pre>

<p><a href="http://aui.github.com/artTemplate/demo/tag.html">演示</a></p>

<h2>
<a name="%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%AD%E6%B3%95" class="anchor" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%AD%E6%B3%95"><span class="octicon octicon-link"></span></a>自定义语法</h2>

<p>artTemplate 提供一个语法扩展用来简化模板逻辑语法。简洁语法示例：</p>

<pre><code>{{if admin}}
    &lt;h3&gt;{{title}}&lt;/h3&gt;
    &lt;ul&gt;
        {{each list}}
            &lt;li&gt;{{$index + 1}}: {{$value}}&lt;/li&gt;
        {{/each}}
    &lt;/ul&gt;
{{/if}}
</code></pre>

<p>请引用 dist/<a href="https://raw.github.com/aui/artTemplate/master/dist/template-simple.js">template-simple.js</a> 即可使用简洁语法。</p>

<p><a href="https://github.com/aui/artTemplate/wiki/%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%AD%E6%B3%95%E6%89%A9%E5%B1%95%E8%AF%B4%E6%98%8E">完整简洁语法说明</a></p>

<h2>
<a name="nodejs" class="anchor" href="#nodejs"><span class="octicon octicon-link"></span></a>NodeJS</h2>

<h3>
<a name="%E5%AE%89%E8%A3%85" class="anchor" href="#%E5%AE%89%E8%A3%85"><span class="octicon octicon-link"></span></a>安装</h3>

<pre><code>$ npm install art-template -g
</code></pre>

<h3>
<a name="%E4%BD%BF%E7%94%A8" class="anchor" href="#%E4%BD%BF%E7%94%A8"><span class="octicon octicon-link"></span></a>使用</h3>

<pre><code>var template = require('art-template');
</code></pre>

<p>（简洁语法版请 <code>require('art-template/dist/template-simple')</code>）</p>

<h2>
<a name="%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7" class="anchor" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7"><span class="octicon octicon-link"></span></a>自动化工具</h2>

<h3>
<a name="%E9%A2%84%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7" class="anchor" href="#%E9%A2%84%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7"><span class="octicon octicon-link"></span></a>预编译工具</h3>

<p>使用它可以让前端模版不再受浏览器的限制，支持如后端模版一样按文件放置、include 语句等特性，可以像后端一样书写前端模板！</p>

<p>项目主页：<a href="https://github.com/aui/tmodjs">https://github.com/aui/tmodjs</a></p>

<h3>
<a name="%E6%8A%BD%E5%8F%96%E5%B7%A5%E5%85%B7" class="anchor" href="#%E6%8A%BD%E5%8F%96%E5%B7%A5%E5%85%B7"><span class="octicon octicon-link"></span></a>抽取工具</h3>

<p><a href="http://aui.github.com/artTemplate/tools/combine.html">./tools/combine.html</a></p>

<p>可以把 HTML 中的模板提取出来以便把模板嵌入到 js 文件中。</p>

<p>与编译工具不同的是，抽取后的模板仍然依赖引擎运行。</p>

<h2>
<a name="%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83" class="anchor" href="#%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83"><span class="octicon octicon-link"></span></a>模板编码规范</h2>

<p>1、不能使用 javascript 关键字作为模板变量(包括 ECMA5 严格模式下新增的关键字):</p>

<blockquote>
<p>break, case, catch, continue, debugger, default, delete, do, else, false, finally, for, function, if, in, instanceof, new, null, return, switch, this, throw, true, try, typeof, var, void, while, with, abstract, boolean, byte, char, class, const, double, enum, export, extends, final, float, goto, implements, import, int, interface, long, native, package, private, protected, public, short, static, super, synchronized, throws, transient, volatile, arguments, let, yield</p>
</blockquote>

<p>2、模板运行在沙箱中，内部无法访问外部变量，除非给模板定义辅助方法。例如：</p>

<pre><code>template.helper('Math', Math)
</code></pre>

<blockquote>
<p>模板中若任意引用外部对象，复杂的依赖管理将会让项目难以维护，这种方式将利于后续模板迁移（包括通过工具预编译）。</p>
</blockquote>

<h2>
<a name="%E6%9B%B4%E6%96%B0%E8%AE%B0%E5%BD%95" class="anchor" href="#%E6%9B%B4%E6%96%B0%E8%AE%B0%E5%BD%95"><span class="octicon octicon-link"></span></a>更新记录</h2>

<h3>
<a name="v203" class="anchor" href="#v203"><span class="octicon octicon-link"></span></a>v2.0.3</h3>

<ol>
<li> 优化辅助方法性能</li>
<li> NodeJS 版本使用 npm 管理</li>
</ol><h3>
<a name="v202" class="anchor" href="#v202"><span class="octicon octicon-link"></span></a>v2.0.2</h3>

<ol>
<li> 优化自定义语法扩展，减少体积</li>
<li> [重要]为了最大化兼容第三方库，自定义语法扩展默认界定符修改为<code>{{</code>与<code>}}</code>。</li>
<li> 修复合并工具的BUG <a href="https://github.com/aui/artTemplate/issues/25">#25</a>
</li>
<li> 公开了内部缓存，可以通过<code>template.cache</code>访问到编译后的函数</li>
<li> 公开了辅助方法缓存，可以通过<code>template.helpers</code>访问到</li>
<li> 优化了调试信息</li>
</ol><h3>
<a name="v201" class="anchor" href="#v201"><span class="octicon octicon-link"></span></a>v2.0.1</h3>

<ol>
<li> 修复模板变量静态分析的<a href="https://github.com/aui/artTemplate/pull/22">BUG</a>
</li>
</ol><h3>
<a name="v20-release" class="anchor" href="#v20-release"><span class="octicon octicon-link"></span></a>v2.0 release</h3>

<ol>
<li> 编译工具更名为 atc，成为 artTemplate 的子项目单独维护：<a href="https://github.com/cdc-im/atc">https://github.com/cdc-im/atc</a>
</li>
</ol><h3>
<a name="v20-beta5" class="anchor" href="#v20-beta5"><span class="octicon octicon-link"></span></a>v2.0 beta5</h3>

<ol>
<li>修复编译工具可能存在重复依赖的问题。感谢 <a href="https://github.com/warmhug" class="user-mention">@warmhug</a>
</li>
<li>修复<code>include</code>内部实现可能产生上下文不一致的问题。感谢 <a href="https://github.com/warmhug" class="user-mention">@warmhug</a>
</li>
<li>支持使用拖拽文件到<code>compile.cmd</code>图标上进行单独编译</li>
</ol><h3>
<a name="v20-beta4" class="anchor" href="#v20-beta4"><span class="octicon octicon-link"></span></a>v2.0 beta4</h3>

<ol>
<li>修复编译工具在压缩模板可能导致 HTML 意外截断的问题。感谢 <a href="https://github.com/warmhug" class="user-mention">@warmhug</a>
</li>
<li>完善编译工具对<code>include</code>支持支持，可以支持不同目录之间模板嵌套</li>
<li>修复编译工具没能正确处理自定义语法插件的辅助方法</li>
</ol><h3>
<a name="v20-beta1" class="anchor" href="#v20-beta1"><span class="octicon octicon-link"></span></a>v2.0 beta1</h3>

<ol>
<li> 对非String、Number类型的数据不输出，而Function类型求值后输出。</li>
<li> 默认对html进行转义输出，原文输出可使用<code>&lt;%==value%&gt;</code>，也可以关闭默认的转义功能<code>template.isEscape = false</code>。</li>
<li> 增加批处理工具支持把模板编译成不依赖模板引擎的 js 文件，可通过 RequireJS、SeaJS 等模块加载器进行异步加载。</li>
</ol><h2>
<a name="%E6%8E%88%E6%9D%83%E5%8D%8F%E8%AE%AE" class="anchor" href="#%E6%8E%88%E6%9D%83%E5%8D%8F%E8%AE%AE"><span class="octicon octicon-link"></span></a>授权协议</h2>

<p>Released under the MIT, BSD, and GPL Licenses</p>

<h1></h1>

<p><a href="http://aui.github.com/artTemplate/demo/index.html">所有演示例子</a> | <a href="http://cdc.tencent.com/?p=5723">引擎原理</a></p>

<p>© cdc.tencent.com</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Arttemplate maintained by <a href="https://github.com/aui">aui</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
